<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />




    <!-- <link rel="stylesheet" type="text/css" href="../css/normalize.css"> -->
    <link rel="stylesheet" type="text/css" href="../frozen/css/frozen.css">
    <link rel="stylesheet" type="text/css" href="../css/default.css">
    <title>HIU</title>


    <link rel="stylesheet" type="text/css" href="../css/mui.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/app.css" />
    <link rel="stylesheet" type="text/css" href="../css/senic.css">

</head>

<body>
    <section class="ui-container mui-content">

        <ul id="OA_task_1" class="mui-table-view">

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

            <li class="mui-table-view-cell">
                <div class="mui-slider-right mui-disabled">
                    <a class="mui-btn mui-btn-red">删除</a>
                </div>
                <div class="mui-slider-handle">
                    <div class="top">
                        <span>用户名: *****190</span>
                        <span>2016-04-26 18:30:30</span>
                    </div>
                    <div class="content">
                        <p>详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论详细评论评论详细评论详细评论详细评论</p>
                    </div>
                </div>
            </li>

        </ul>
    </section>




    <script src="../js/mui.min.js"></script>
    <script src="../js/jquery-1.10.2.js"></script>
    <script>
        mui.init();
        (function($) {
            var btnArray = ['确认', '取消'];
            $('#OA_task_1').on('tap', '.mui-btn', function(event) {
                var elem = this;
                var li = elem.parentNode.parentNode;
                mui.confirm('确认删除该条记录？', 'Hello MUI', btnArray, function(e) {
                    if (e.index == 0) {
                        li.parentNode.removeChild(li);
                    } else {
                        setTimeout(function() {
                            $.swipeoutClose(li);
                        }, 0);
                    }
                });
            });
        })(mui);

        getData();
        var offset = 0;

        function getData() {
            $("#more").removeAttr("onclick");
            $("#more").html("加载中");

            var html = $("#OA_task_1").html();
            $.ajax({
                url: "/sdhiu/driver/driverMsgInfo",
                async: false,
                type: "POST",
                data: {
                    offset: offset
                },
                success: function(data) {
                    data = eval("(" + data + ")");
                    var i = 0;
                    for (var i in data) {
                        var li = '';
                        li += '<li class="mui-table-view-cell" id="' + data[i].id + '">';
                        li += '<div class="mui-slider-right mui-disabled">';
                        li += '<a class="mui-btn mui-btn-red">删除</a>';
                        li += '</div>';
                        li += '<div class="mui-slider-handle">';
                        li += '<div class="top">';
                        li += '<span></span>';
                        li += '<span>' + data[i].date + '</span>';
                        li += '</div>';
                        li += '<div class="content">';
                        li += '<p>' + data[i].content + '</p>';
                        li += '</div>';
                        li += '</div>';
                        li += '</li>';
                        html += li;
                        offset++;
                        i++;
                    }
                    if (i < 10) {
                        $("#more").removeAttr("onclick");
                        $("#more").html("没有更多了");
                    } else {
                        $("#more").attr("onclick", "getData()");
                        $("#more").html("加载更多");
                    }
                    $("#OA_task_1").html(html);
                },
                error: function(data) {
                    console.log("error");
                }
            });

        }






        mui.ajax('./sdhiu/driver/driverMsgInfo', {
            data: {
                offset: offset
            },
            async:false,
            type: 'post', //HTTP请求类型
            timeout: 10000, //超时时间设置为10秒；
            headers: {
                'Content-Type',
                'application/json'
            }
            success: function(data) {
              data = eval("(" + data + ")");
              var i = 0;
              for (var i in data) {
                  var li = '';
                  li += '<li class="mui-table-view-cell" id="' + data[i].id + '">';
                  li += '<div class="mui-slider-right mui-disabled">';
                  li += '<a class="mui-btn mui-btn-red">删除</a>';
                  li += '</div>';
                  li += '<div class="mui-slider-handle">';
                  li += '<div class="top">';
                  li += '<span></span>';
                  li += '<span>' + data[i].date + '</span>';
                  li += '</div>';
                  li += '<div class="content">';
                  li += '<p>' + data[i].content + '</p>';
                  li += '</div>';
                  li += '</div>';
                  li += '</li>';
                  html += li;
                  offset++;
                  i++;
              }
              if (i < 10) {
                  $("#more").removeAttr("onclick");
                  $("#more").html("没有更多了");
              } else {
                  $("#more").attr("onclick", "getData()");
                  $("#more").html("加载更多");
              }
              $("#OA_task_1").html(html);
            },

            error: function(data) {
                //异常处理；
                console.log("error");
            }
        })

        function deleteMsg(id) {
            if (id != null) {
                alert(id)
                $.ajax({
                    url: "/sdhiu/driver/driverMsgDelete",
                    async: true,
                    type: "POST",
                    data: {
                        id: id
                    },
                    success: function(data) {

                    },
                    error: function(data) {
                        console.log("error");
                    }
                });
            }
        }
    </script>
</body>

</html>
